{
    "contents" : "#' @import TeachingSampling\n#' @import timeDate\n#' @export\n#' \n#' @title\n#' Statistical power for a hyphotesis testing on a single variance\n#' @description \n#' This function computes the power for a (right tail) test of variance \n#' @return \n#' The power of the test.\n#' @details\n#' We note that the power is defined as: \\deqn{1-\\Phi(Z_{1-\\alpha} - \\frac{(D-P)}{\\sqrt{\\frac{DEFF}{n}(1-\\frac{n}{N})(P (1-P))}})}\n#' @author Hugo Andres Gutierrez Rojas <hugogutierrez at usantotomas.edu.co>\n#' @param N The population size.\n#' @param n The sample size.\n#' @param S2 The value of the first estimated proportion.\n#' @param S20 The value of the null effect. Note that \\code{S2} must be strictly smaller than \\code{S2}.\n#' @param K The excess kurtosis of the variable in the population.\n#' @param DEFF The design effect of the sample design. By default \\code{DEFF = 1}, which corresponds to a simple random sampling design.\n#' @param conf The statistical confidence. By default \\code{conf = 0.95}.\n#' @param power The statistical power. By default power = 0.80.\n#' @param plot Optionally plot the power achieved for an specific sample size.\n#' \n#' @references \n#' Gutierrez, H. A. (2009), \\emph{Estrategias de muestreo: Diseno de encuestas y estimacion de parametros}. Editorial Universidad Santo Tomas\n#' @seealso \\code{\\link{ss4p}}\n#' @examples \n#' b4S2(N = 100000, n = 400, S2 = 120, S20 = 100, K = 0, DEFF = 1)\n#' b4S2(N = 100000, n = 400, S2 = 120, S20 = 100, K = 2, DEFF = 1)\n#' b4S2(N = 100000, n = 400, S2 = 120, S20 = 100, K = 2, DEFF = 2.5, plot = TRUE)\n\nb4S2 <- function (N, n, S2, S20, K=0, DEFF = 1, conf = 0.95, power = 0.8, plot = FALSE){\n  Za = conf\n  Zb = power\n  Z = qnorm(Za) + qnorm(Zb)\n  D = abs(S2 - S20)\n  f = n/N\n  VAR = DEFF * (1/n) * (1 - f) * N^2 * (K*N + 2*N +2) * S2^2 / ((N - 1)^3)\n  beta = 100 * (1 - pnorm(Za - (D / sqrt(VAR))))\n  if (plot == TRUE) {\n    nseq = seq(1, N, 10)\n    betaseq = rep(NA, length(nseq))\n    for (k in 1:length(nseq)) {\n      fseq = nseq[k]/N\n      varseq = DEFF * (1/nseq[k]) * (1 - fseq) * N^2 * (K*N + 2*N +2) * S2^2 / ((N - 1)^3)\n      betaseq[k] = 100 * (1 - pnorm(Za - (D /sqrt(varseq))))\n    }\n    plot(nseq, betaseq, type = \"l\", lty = 1, pch = 1, col = 3, \n         ylab = \"Power of the test (%)\", xlab = \"Sample Size\")\n    points(n, beta, pch = 8, bg = \"blue\")\n    abline(h = beta, lty = 3)\n    abline(v = n, lty = 3)\n  }\n  msg <- cat(\"With the parameters of this function: N =\", N, \n             \"n = \", n, \"S2 =\", S2, \"S20 =\", S20, \"Kurtosis =\", K, \"D =\", D, \"DEFF = \", DEFF, \"conf =\", \n             conf, \". \\nThe estimated power of the test is \", beta, \n             \". \\n \\n\")\n  result <- list(Power = beta)\n  result\n}\n",
    "created" : 1454617832102.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2527996250",
    "id" : "4AC1EE0F",
    "lastKnownWriteTime" : 1454627246,
    "path" : "~/Desktop/Dropbox/ProducciÃ³n/Software/github/samplesize4surveys/R/b4S2.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "type" : "r_source"
}