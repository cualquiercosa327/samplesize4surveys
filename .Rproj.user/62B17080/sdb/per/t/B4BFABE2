{
    "contents" : "#' @import TeachingSampling\n#' @import timeDate\n#' @export\n#' \n#' @title\n#' The required sample size for testing a null hyphotesis for a single variance\n#' @description \n#' This function returns the minimum sample size required for testing a null hyphotesis regarding a single variance\n#' @details\n#' We assume that it is of interest to test the following set of hyphotesis:\n#' \\deqn{H_0: P - P_0 = 0 \\ \\ \\ \\ vs. \\ \\ \\ \\ H_a: P - P_0 = D > 0 }\n#' Note that the minimun sample size, restricted to the predefined power \\eqn{\\beta} and confidence \\eqn{1-\\alpha}, is defined by: \n#' \\deqn{n = \\frac{S2^2}{\\frac{D^2}{(z_{1-\\alpha} + z_{\\beta})^2}\\frac{(N-1)^3}{N^2(N*K+2N+2)}+\\frac{S2^2}{N}}}\n#'  \n#' @author Hugo Andres Gutierrez Rojas <hugogutierrez at usantotomas.edu.co>\n#' @param N The population size.\n#' @param S2 The value of the estimated variance\n#' @param S20 The value to test for the single variance\n#' @param K The excess kurtosis of the variable in the population.\n#' @param DEFF The design effect of the sample design. By default \\code{DEFF = 1}, which corresponds to a simple random sampling design.\n#' @param conf The statistical confidence. By default \\code{conf = 0.95}.\n#' @param power The statistical power. By default \\code{power = 0.80}.\n#' @param plot Optionally plot the effect against the sample size.\n#' \n#' @references \n#' Gutierrez, H. A. (2009), \\emph{Estrategias de muestreo: Diseno de encuestas y estimacion de parametros}. Editorial Universidad Santo Tomas\n#' @seealso \\code{\\link{e4p}}\n#' @examples \n#' \n#' ss4S2H(N = 10000, S2 = 120, S20 = 110, K = 0)\n#' ss4S2H(N = 10000, S2 = 120, S20 = 110, K = 2, DEFF = 2, power = 0.9)\n#' ss4S2H(N = 10000, S2 = 120, S20 = 110, K = 2, DEFF = 2, power = 0.8, plot = TRUE)\n#' \n#' #############################\n#' # Example with BigLucy data #\n#' #############################\n#' data(BigLucy)\n#' attach(BigLucy)\n#' N <- nrow(BigLucy)\n#' S2 <- var(BigLucy$Income)\n#' \n#' # The minimum sample size for testing \n#' # H_0: S2 - S2_0 = 0   vs.   H_a: S2 - S2_0 = D = 8000\n#' D = 8000 \n#' S20 = S2 - D \n#' K <- kurtosis(BigLucy$Income)\n#' ss4S2H(N, S2, S20, K, DEFF=1, conf = 0.99, power = 0.8, plot=TRUE)\n\nss4S2H <- function(N, S2, S20, K=0, DEFF=1, conf=0.95, power=0.8, plot=FALSE){\n  \n  Za = conf\n  Zb = power\n  Z = qnorm(Za) + qnorm(Zb)\n  D = abs(S2 - S20)\n  n.hyp = S2^2 * DEFF / (D^2 * (N - 1)^3/(Z^2 * N^2 * (K*N + 2*N + 2)) + S2^2 * DEFF / N)\n  n.hyp = ceiling(n.hyp)\n  if (plot == TRUE) {\n    nseq = seq(100, N, 10)\n    Dseq = rep(NA, length(nseq))\n    for (k in 1:length(nseq)) {\n      fseq = nseq[k]/N\n      varseq = DEFF * (1/fseq) * (1 - fseq) * N * (K*N + 2*N + 2) * (S2^2) * (qnorm(Za) + qnorm(Zb))^2 / ((N - 1)^3)\n      Dseq[k] = sqrt(varseq)\n    }\n    plot(nseq, Dseq, type = \"l\", lty = 2, pch = 1, col = 3, \n         ylab = \"Null effect (D) \", xlab = \"Sample size\")\n    points(n.hyp, D, pch = 8, bg = \"blue\")\n    abline(h = D, lty = 3)\n    abline(v = n.hyp, lty = 3)\n  }\n  result = n.hyp\n  result\n}\n\n",
    "created" : 1454616566304.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "809316345",
    "id" : "B4BFABE2",
    "lastKnownWriteTime" : 1454617742,
    "path" : "~/Desktop/Dropbox/ProducciÃ³n/Software/github/samplesize4surveys/R/ss4S2H.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "type" : "r_source"
}