{
    "collab_server" : "",
    "contents" : "#' @import TeachingSampling\n#' @export\n#' \n#' @title\n#' Statistical errors for the estimation of a difference of means \n#' @description \n#' This function computes the cofficient of variation and the standard error when estimating a difference of means under a complex sample design.\n#' @return \n#' The coefficient of variation and the margin of error for a predefined sample size.\n#' @details\n#' We note that the coefficent of variation is defined as: \\deqn{cve = \\frac{\\sqrt{Var(\\bar{y}_1 - \\bar{y}_2)}}{\\bar{y}_1 - \\bar{y}_2}} \n#' Also, note that the magin of error is defined as: \\deqn{\\varepsilon = z_{1-\\frac{\\alpha}{2}}\\sqrt{Var(\\bar{y}_1 - \\bar{y}_2)}}\n#'  \n#' @author Hugo Andres Gutierrez Rojas <hugogutierrez at usantotomas.edu.co>\n#' @param N The population size.\n#' @param n The sample size.\n#' @param mu1 The value of the estimated mean of the variable of interes for the first population.\n#' @param mu2 The value of the estimated mean of the variable of interes for the second population.\n#' @param sigma1 The value of the estimated variance of the variable of interes for the first population.\n#' @param sigma2 The value of the estimated mean of a variable of interes for the second population.\n#' @param DEFF The design effect of the sample design. By default \\code{DEFF = 1}, which corresponds to a simple random sampling design.\n#' @param conf The statistical confidence. By default \\code{conf = 0.95}.\n#' @param plot Optionally plot the errors (cve and margin of error) against the sample size.\n#' \n#' @references \n#' Gutierrez, H. A. (2009), \\emph{Estrategias de muestreo: Diseno de encuestas y estimacion de parametros}. Editorial Universidad Santo Tomas\n#' @seealso \\code{\\link{ss4p}}\n#' @examples \n#' e4dm(N=10000, n=400, mu1 = 100, mu2 = 12, sigma1 = 10, sigma2=8)\n#' e4dm(N=10000, n=400, mu1 = 100, mu2 = 12, sigma1 = 10, sigma2=8, plot=TRUE)\n#' e4dm(N=10000, n=400, mu1 = 100, mu2 = 12, sigma1 = 10, sigma2=8, DEFF=3.45, conf=0.99, plot=TRUE)\n\n\ne4dm <- function(N, n, mu1, mu2, sigma1, sigma2, DEFF = 1, conf = 0.95, plot = FALSE) {\n  \n  S2 <- DEFF * (sigma1^2 + sigma2^2)\n  Z <- 1 - ((1 - conf)/2)\n  f <- n/N\n  VAR <- (1/n) * (1 - f) * S2\n  CVE <- 100 * sqrt(VAR)/abs(mu1 - mu2)\n  ME <- qnorm(Z) * sqrt(VAR)\n  \n  if (plot == TRUE) {\n    \n    nseq <- seq(1, N, 10)\n    cveseq <- rep(NA, length(nseq))\n    meseq <- rep(NA, length(nseq))\n    \n    for (k in 1:length(nseq)) {\n      fseq <- nseq[k]/N\n      varseq <- (1/nseq[k]) * (1 - fseq) * S2\n      cveseq[k] <- 100 * sqrt(varseq)/abs(mu1 - mu2)\n      meseq[k] <- qnorm(Z) * sqrt(varseq)\n    }\n    \n    par(mfrow = c(1, 2))\n    plot(nseq, cveseq, type = \"l\", lty = 1, pch = 1, col = 3, ylab = \"Coefficient of variation (%)\", xlab = \"Sample Size\")\n    points(n, CVE, pch = 8, bg = \"blue\")\n    abline(h = CVE, lty = 3)\n    abline(v = n, lty = 3)\n    \n    plot(nseq, meseq, type = \"l\", lty = 1, pch = 1, col = 3, ylab = \"Margin of error\", xlab = \"Sample Size\")\n    points(n, ME, pch = 8, bg = \"blue\")\n    abline(h = ME, lty = 3)\n    abline(v = n, lty = 3)\n  }\n  \n  msg <- cat(\"With the parameters of this function: N =\", N, \"n = \", n, \"mu1 =\", mu1, \"mu2 =\", mu2,\n             \"sigma1 =\", sigma1, \"sigma2 =\", sigma2, \"DEFF = \", DEFF, \"conf =\", conf, \". \n             \\nThe estimated coefficient of variation is \", CVE, \". \n             \\nThe margin of error is\", ME, \". \\n \\n\")\n  \n  result <- list(cve = CVE, Margin_of_error = ME)\n  result\n} ",
    "created" : 1504104454226.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3965288189",
    "id" : "7CD5263",
    "lastKnownWriteTime" : 1430688676,
    "last_content_update" : 1430688676,
    "path" : "~/Desktop/Dropbox/ProducciÃ³n/Software/github/samplesize4surveys/R/e4dm.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}